## [CVE-2022-21970](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21970)

## Description

This vulnerability allows an attacker to execute javascript code on every host without permission, also an attacker can steal local system files, and also he can manipulate the actions against the machine and result in changing internal developer settings in Microsoft Edge.

- NOTE: In this example, Microsoft Edge executes a malicious script without problems.
This is just a malicious .bat file that reboots the infected machine, and it's only for testing!
The attacker can create a malicious file that can take a privileges escalation, malware, spyware, or kernel exploit file and harm seriously your device!
Not correctly sanitizing and checking for that what users download on their machines by using a MsEdge!

NOTE after the exploit: A malicious user, or whatever user can execute directly malicious .bat files which are created - generated from this javascript exploit by using MsEdge. 游때
According to Edge, this file is safe to run and open. 游때
Screenshot, example:

------------------------------------------------------------------------------------------------------------------------------------------------

## FAQ
What is the version information for this release?

Microsoft Edge Version	Date Released	Based on Chromium Version

97.0.1072.55 | 1/6/2022	 | 97.0.4692.71

## STATUS:
- Patched and fixed on!
![](https://github.com/nu11secur1ty/Windows10Exploits/blob/master/2022/CVE-2022-21970/Docs/Edge-Fix.png)

------------------------------------------------------------------------------------------------------------

# The next test is checking if this is fully patched! 游뱖 游땥 游땙

## Proof and simple browser test MsEdge: Edge is blocking `.sys` files because they can harm your device:

![](https://github.com/nu11secur1ty/Windows10Exploits/blob/master/2022/CVE-2022-21970/Docs/edge-patch.png)

## This proof of concept is shown as to how the MsEdge browser NOT blocking `.bat` files, and this is a problem.

- NOTE: A malicious user, or whatever user can execute directly malicious `.bat` files which are created - generated from this `javascript exploit` by using MsEdge. 游때
- According to Edge, this file is safe to run and open. 游때
- Screenshot, example:

![](https://github.com/nu11secur1ty/Windows10Exploits/blob/master/2022/CVE-2022-21970/Docs/Screenshot%202022-01-18%20122501.png)

## In Action:

1. download the PoC

2. extracted somewhere

3. Execute

```cmd
start msedge C:\Users\user2022\Desktop\ExploitServer\examples\exploit.html
```

## Reproduce:
[href](https://github.com/nu11secur1ty/Windows10Exploits/edit/master/2022/CVE-2022-21970)

## Proof and Exploit:

[href](https://streamable.com/solcg7)

- BR nu11secur1ty
